-| Important notes for training with a GPU remotely inside a Singularity container.

Container:
- Know how to stop the container
- Use a .simg container to run experiments
- Keep the container in image format in the home (network) folder
- It may be needed to bind the /srv/storage/datasets/gabrielsluz/ to a folder in the container
- Containers can only be created in proc2 or echer /srv/forge
- Only use sudo when needed.

GPU usage:
- Always check if there is someone using the CPU or the GPU
- Use window multiplex to inspect the training
- Check if the GPU is being used corectly

Storage:
- Datasets must be kept in the storage. => '/srv/storage/datasets/gabrielsluz/'
- Where to keep the results and best models ? => Storage seems a good option
- Which results => Prefer more than less, as the experiments are quite expensive. 
    - The model may be a must.
    - Validation and training errors



-| Testing GPU:
- Create a singularity container in echer or proc2 /srv/forge (may need to be cuda container):
sudo singularity build --sandbox mnist_test docker://python:3.6
sudo singularity shell --writable mnist_test/

- Put the teste_gpu.py in it and install requirements
git clone https://github.com/gabrielsluz/POC1.git
pip install -r ./POC1/gpu_test/requirements.txt

- Create /MNIST dir
mkdir /MNIST

- Bind the /srv/storage/datasets/gabrielsluz/ to /MNIST in the container
CNTRL-d
sudo singularity shell -B /srv/storage/datasets/gabrielsluz:/MNIST --writable mnist_test/

- Create the simg container: sudo singularity build my_ubuntu.simg my_container/
- Run it on the machine (Check everything you need to check to use the gpu)
- Test the command: nvidia-smi
- Test the teste_gpu.py, by running: python ./POC1/gpu_test/teste_gpu.py --epochs 1